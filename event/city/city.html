<!DOCTYPE html>
<html>
<head>
<title>活力圈</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1, maximum-scale=1, user-scalable=no" />
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
<meta name="distribution" content="global" />
<meta name="author" content="活力圈" />
<meta name="webcrawlers" content="all" />
</head>
<body>
测试百度地图
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=7PYhGyOwtM945XwUE3koKalNmfF15Eox"></script>
<script type="text/javascript">


	var geolocation = new BMap.Geolocation();
	geolocation.getCurrentPosition(function(r){
		if(this.getStatus() == BMAP_STATUS_SUCCESS){
			var mk = new BMap.Marker(r.point);
			alert('您的位置：'+r.point.lng+','+r.point.lat);
		}
		else {
			alert('failed'+this.getStatus());
		}        
	},{enableHighAccuracy: true})

	//关于状态码
	//BMAP_STATUS_SUCCESS	检索成功。对应数值“0”。
	//BMAP_STATUS_CITY_LIST	城市列表。对应数值“1”。
	//BMAP_STATUS_UNKNOWN_LOCATION	位置结果未知。对应数值“2”。
	//BMAP_STATUS_UNKNOWN_ROUTE	导航结果未知。对应数值“3”。
	//BMAP_STATUS_INVALID_KEY	非法密钥。对应数值“4”。
	//BMAP_STATUS_INVALID_REQUEST	非法请求。对应数值“5”。
	//BMAP_STATUS_PERMISSION_DENIED	没有权限。对应数值“6”。(自 1.1 新增)
	//BMAP_STATUS_SERVICE_UNAVAILABLE	服务不可用。对应数值“7”。(自 1.1 新增)
	//BMAP_STATUS_TIMEOUT	超时。对应数值“8”。(自 1.1 新增)
	
	
 
	// 获取位置坐标
	/*
	if (navigator.geolocation){
		navigator.geolocation.getCurrentPosition(getPositionSuccess,showError,position_option);
	}
	else{
		var myCity = new BMap.LocalCity();
		myCity.get(myFun);
	};
	*/
	
	var myCity = new BMap.LocalCity();
	myCity.get(myFun);
	
	
	function myFun(result){
		setLocationCity(result.name);
	}
	
	function getPositionSuccess( position ){		
		var myGeo = new BMap.Geocoder();  
		myGeo.getLocation(new BMap.Point(position.coords.longitude, position.coords.latitude), function(result){      
			if (result){      
				var addComp = result.addressComponents; 
				setLocationCity(addComp.city);   
			}      
		}); 			
	};	
	
	var setLocationCity = function(cityName){
		alert(cityName);
		console.log(cityName);
		if (cityName == '广州市'){
			city_id = '1';
			city_name = '广州';
		}else if(cityName == "深圳市"){
			city_id = '1';
			city_name = '广州';
		}

	};
	
	var position_option = {
		enableHighAccuracy: false,  //是否启用高精度设备
		maximumAge: 30000, //告诉设备缓存时间
		timeout: 20000	//超时事件，获取位置信息时超出设定的这个时长，将会触发错误，捕获错误的函数将被调用，并且错误码指向TIMEOUT。
	};	
	var showError = function(error){
		// error拥有一个code属性和三个常量属性TIMEOUT、PERMISSION_DENIED、POSITION_UNAVAILABLE
		// 执行失败时，code属性会指向三个常量中的一个，从而指明错误原因
		var myCity = new BMap.LocalCity();
		myCity.get(myFun);
		switch(error.code){
			case error.TIMEOUT:
				console.log('超时');
				break;
			case error.PERMISSION_DENIED:
				console.log('用户拒绝提供地理位置');
				break;
			case error.POSITION_UNAVAILABLE:
				console.log('地理位置不可用');
				break;
			default:
				break;
		}
	};
 
</script>
</body>
</html>